<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“Š Daily Researcher - éé—æ‰‹å·¥å‡ºæµ·å…¨çƒè¶‹åŠ¿æ´å¯Ÿ</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .loading-spinner {display:inline-block;width:20px;height:20px;border:2px solid #f3f3f3;border-top:2px solid #3498db;border-radius:50%;animation:spin 1s linear infinite}
        @keyframes spin {0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
        .date-selector {background:white;padding:1rem;border-radius:12px;margin-bottom:1.5rem;box-shadow:0 2px 10px rgba(0,0,0,0.1);display:flex;align-items:center;gap:1rem;flex-wrap:wrap}
        .date-selector select {padding:0.5rem 1rem;border:2px solid #3498db;border-radius:8px;font-size:1rem;cursor:pointer;background:white;min-width:150px}
        .current-badge {background:#27ae60;color:white;padding:0.3rem 0.8rem;border-radius:20px;font-size:0.8rem;margin-left:auto}
    </style>
</head>
<body>
    <header>
        <h1>ğŸ“Š Daily Researcher</h1>
        <p>éé—æ‰‹å·¥å‡ºæµ· Â· å…¨çƒè¶‹åŠ¿æ´å¯Ÿä»ªè¡¨æ¿</p>
        <p class="last-updated">æœ€åæ›´æ–°ï¼š<span id="update-time">åŠ è½½ä¸­...</span></p>
    </header>
    <nav>
        <a href="index.html" class="active">ä»ªè¡¨æ¿</a>
        <a href="competitor.html">ç«å“åŠ¨æ€</a>
        <a href="social.html">ç¤¾äº¤è¶‹åŠ¿</a>
        <a href="supply-chain.html">ä¾›åº”é“¾æœˆæŠ¥</a>
    </nav>
    <main>
        <div class="date-selector">
            <label>ğŸ“… é€‰æ‹©æ—¥æœŸï¼š</label>
            <select id="date-select" onchange="loadDataByDate()"><option value="">åŠ è½½ä¸­...</option></select>
            <span class="current-badge" id="current-badge">åŠ è½½ä¸­...</span>
        </div>
        <section class="metrics">
            <div class="metric-card">
                <h3>ğŸ”¥ ä»Šæ—¥çƒ­ç‚¹</h3>
                <ul id="hot-topics"><li style="padding:1rem;text-align:center;color:#7f8c8d"><span class="loading-spinner"></span>åŠ è½½ä¸­...</li></ul>
            </div>
            <div class="metric-card">
                <h3>ğŸ·ï¸ çƒ­é—¨æ ‡ç­¾</h3>
                <div id="tag-cloud" class="tag-cloud" style="padding:1rem;text-align:center;color:#7f8c8d"><span class="loading-spinner"></span>åŠ è½½ä¸­...</div>
            </div>
        </section>
        <section class="charts">
            <div class="chart-container">
                <h3>ğŸ“ˆ è¶‹åŠ¿çƒ­åº¦å˜åŒ–</h3>
                <canvas id="trendChart"></canvas>
            </div>
            <div class="chart-container">
                <h3>ğŸ¥§ å“ç±»åˆ†å¸ƒ</h3>
                <canvas id="categoryChart"></canvas>
            </div>
        </section>
        <section class="quick-links">
            <h3>ğŸ“± å¿«é€ŸæŸ¥çœ‹</h3>
            <div class="link-cards">
                <a href="competitor.html" class="link-card"><span class="icon">ğŸ›’</span><span class="title">ç«å“åŠ¨æ€</span><span class="desc">Amazon/Etsy/TikTok Shop</span></a>
                <a href="social.html" class="link-card"><span class="icon">ğŸ¨</span><span class="title">ç¤¾äº¤è¶‹åŠ¿</span><span class="desc">TikTok/Pinterest/IPçƒ­ç‚¹</span></a>
                <a href="supply-chain.html" class="link-card"><span class="icon">ğŸ“¦</span><span class="title">ä¾›åº”é“¾æœˆæŠ¥</span><span class="desc">å…¨å›½äº§åŒº/åŸææ–™</span></a>
            </div>
        </section>
    </main>
    <footer><p>ğŸ“Š Daily Researcher | éé—æ‰‹å·¥å‡ºæµ·è¶‹åŠ¿æ´å¯Ÿ</p><p>æ•°æ®æ¥æºï¼šAmazon, Etsy, TikTok Shop, Pinterest</p></footer>
    <script>
    var Utils={formatDate:function(d){return new Date(d).toLocaleString('zh-CN',{year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'})},formatNumber:function(n){if(n>=1000000000)return(n/1000000000).toFixed(1)+'B';if(n>=1000000)return(n/1000000).toFixed(1)+'M';if(n>=1000)return(n/1000).toFixed(1)+'K';return n.toString()},getTagSize:function(c,m){var r=c/m;if(r>0.8)return'size-5';if(r>0.6)return'size-4';if(r>0.4)return'size-3';if(r>0.2)return'size-2';return'size-1'}};
    var ChartUtils={createLineChart:function(c,l,d){new Chart(c,{type:'line',data:{labels:l,datasets:d.map(function(v,i){return{label:v.label,data:v.data,borderColor:['#3498db','#e74c3c','#27ae60'][i%3],backgroundColor:'transparent',tension:0.4,fill:false}}},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'bottom'}},scales:{y:{beginAtZero:false}}})},createPieChart:function(c,l,d){new Chart(c,{type:'doughnut',data:{labels:l,datasets:[{data:d,borderWidth:2,borderColor:'#fff',backgroundColor:['#3498db','#e74c3c','#27ae60','#f39c12','#9b59b6','#1abc9c']}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'right'}}})}};
    var currentDate=new Date().toISOString().split('T')[0];var availableDates=[];
    function scanAvailableDates(){fetch('data/competitor/').then(function(r){return r.text()}).then(function(t){var m=t.match(/2026-\d{2}-\d{2}/g);var dates=m? [...new Set(m)].sort().reverse():['2026-02-07','2026-02-06','2026-02-05','2026-02-04'];Promise.all(dates.map(function(d){return fetch('data/competitor/'+d+'.json').then(function(r){return r.ok?d:null})})).then(function(valid){availableDates=valid.filter(function(d){return d});if(availableDates.length===0)availableDates=['2026-02-07','2026-02-06','2026-02-05','2026-02-04'];var s=document.getElementById('date-select');s.innerHTML=availableDates.map(function(d){var cn=d.replace(/(\d{4})-(\d{2})-(\d{2})/,'$1å¹´$2æœˆ$3æ—¥');return'<option value="'+d+'">'+cn+'</option>'}).join('');var td=new Date().toISOString().split('T')[0];currentDate=availableDates.includes(td)?td:availableDates[0];s.value=currentDate;document.getElementById('current-badge').textContent='æœ€æ–°æ•°æ®';initDashboard()})})['catch'](function(){availableDates=['2026-02-07','2026-02-06','2026-02-05','2026-02-04'];var s=document.getElementById('date-select');s.innerHTML=availableDates.map(function(d){var cn=d.replace(/(\d{4})-(\d{2})-(\d{2})/,'$1å¹´$2æœˆ$3æ—¥');return'<option value="'+d+'">'+cn+'</option>'}).join('');currentDate=availableDates[0];initDashboard()})}
    function loadDataByDate(){var s=document.getElementById('date-select');currentDate=s.value;var td=new Date().toISOString().split('T')[0];var b=document.getElementById('current-badge');b.textContent=currentDate===td?'æœ€æ–°æ•°æ®':'å†å²æ•°æ®';b.style.background=currentDate===td?'#27ae60':'#f39c12';document.getElementById('hot-topics').innerHTML='<li style="padding:1rem;text-align:center"><span class="loading-spinner"></span>åŠ è½½ä¸­...</li>';document.getElementById('tag-cloud').innerHTML='<span style="color:#7f8c8d"><span class="loading-spinner"></span>åŠ è½½ä¸­...</span>';initDashboard()}
    function initDashboard(){console.log('Dashboard init',currentDate);document.getElementById('update-time').textContent=Utils.formatDate(new Date());fetch('data/competitor/'+currentDate+'.json').then(function(r){if(!r.ok)throw new Error('No data');return r.json()})['catch'](function(){var nextDate=availableDates.find(function(d){return d!==currentDate});return nextDate?fetch('data/competitor/'+nextDate+'.json').then(function(r){if(!r.ok)throw new Error('No data');currentDate=nextDate;document.getElementById('date-select').value=nextDate;return r.json()}):Promise.reject('No valid date')}).then(function(data){console.log('Data loaded',data);var hc=document.getElementById('hot-topics');if(data.hotProducts&&data.hotProducts.length>0){hc.innerHTML=data.hotProducts.slice(0,5).map(function(p,i){return'<li class="product-item"><span class="product-rank">'+(i+1)+'</span><div class="product-info"><div class="product-name">'+p.name+'</div><div class="product-meta">'+p.platform+' Â· '+p.price+'</div></div><span class="product-price">'+p.sales+'</span></li>'}).join('')}else{hc.innerHTML='<li style="padding:1rem;color:#7f8c8d">æš‚æ— æ•°æ®</li>'}var tc=document.getElementById('tag-cloud');if(data.trendingTags&&data.trendingTags.length>0){var mc=Math.max.apply(Math,data.trendingTags.slice(0,15).map(function(t){return t.count||1}));tc.innerHTML=data.trendingTags.slice(0,15).map(function(t){return'<span class="tag '+Utils.getTagSize(t.count||1,mc)+'">'+t.name+'</span>'}).join('')}else{tc.innerHTML='<span style="color:#7f8c8d">æš‚æ— æ ‡ç­¾æ•°æ®</span>'}if(data.trendData){ChartUtils.createLineChart(document.getElementById('trendChart').getContext('2d'),data.trendData.labels,data.trendData.datasets)}if(data.categoryDistribution){ChartUtils.createPieChart(document.getElementById('categoryChart').getContext('2d'),data.categoryDistribution.labels,data.categoryDistribution.data)}console.log('Dashboard rendered')})['catch'](function(e){console.error('Error',e);document.getElementById('hot-topics').innerHTML='<li style="padding:1rem;color:#e74c3c">æ•°æ®åŠ è½½å¤±è´¥</li>';document.getElementById('tag-cloud').innerHTML='<span style="color:#e74c3c">æ•°æ®åŠ è½½å¤±è´¥</span>'})}
    if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',scanAvailableDates)}else{scanAvailableDates()}
    </script>
</body>
</html>
